Parameters:
  PrimarySiteDomainName:
    Type: String
    Description: Primary domain name

Resources:
  #
  # main bucket
  #
  SiteBucket:
    Type: AWS::S3::Bucket
    DeletionPolicy: Delete
    Properties:
      AccessControl: PublicRead
      BucketName: !Ref PrimarySiteDomainName
      WebsiteConfiguration:
        IndexDocument: index.html

  #
  # redirect buckets
  #
  RedirectBucketRikbrownCoUk:
    Type: AWS::S3::Bucket
    DeletionPolicy: Delete
    Properties:
      AccessControl: PublicRead
      BucketName: rikbrown.co.uk
      WebsiteConfiguration:
        RedirectAllRequestsTo: 
          HostName: !Ref PrimarySiteDomainName
          Protocol: http
  RedirectBucketRikCodes:
    Type: AWS::S3::Bucket
    DeletionPolicy: Delete
    Properties:
      AccessControl: PublicRead
      BucketName: rik.codes
      WebsiteConfiguration:
        RedirectAllRequestsTo: 
          HostName: !Ref PrimarySiteDomainName
          Protocol: http
  RedirectBucketWwwRikCodes:
    Type: AWS::S3::Bucket
    DeletionPolicy: Delete
    Properties:
      AccessControl: PublicRead
      BucketName: www.rik.codes
      WebsiteConfiguration:
        RedirectAllRequestsTo: 
          HostName: !Ref PrimarySiteDomainName
          Protocol: http

Outputs:
  SiteBucketName: 
    Value: !Ref PrimarySiteDomainName
    Description: Bucket for primary site content
